# Save this script as create_test_exe.py
import os


def create_dummy_exe(file_path="test_malware.exe"):
    # Add a simple header (imitating an executable)
    pe_header = b"MZ" + b"\x00" * 58 + \
        b"\x40\x00\x00\x00"  # Mimics PE executable format
    malicious_code = b"malicious_code"  # String to trigger YARA rule
    padding = b"\x90" * 100  # NOP sled (for realistic padding)

    # Write the dummy file
    with open(file_path, "wb") as f:
        f.write(pe_header + malicious_code + padding)

    print(f"Dummy executable created at: {file_path}")


if __name__ == "__main__":
    create_dummy_exe()
